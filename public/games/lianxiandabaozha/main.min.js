var Config=function(){function t(){}var e=__define,i=t,n=i.prototype;return n.init=function(){this._grade=.5,this._hor=7,this._ver=8,this._skin=1,this._bombMaxRound=5,this._reward=[{score:"20",url:"http://www.baidu.com"},{score:"2048",url:"http://www.baidu.com"}]},e(n,"reward",void 0,function(t){this._reward=t,console.log(this._reward)}),e(n,"hor",function(){return this._hor}),e(n,"ver",function(){return this._ver}),e(t,"tileSize",function(){return this.gridBgW/7}),e(t,"gridW",function(){return this.gridBgW/7.5}),e(t,"gridH",function(){return this.gridBgH/8.6}),e(n,"grade",function(){return this._grade}),e(t,"gridBgW",function(){return StageUtils.stageW-50}),e(t,"gridBgH",function(){return 684}),e(t,"anInterval",function(){return 50}),e(t,"removeTime",function(){return 300}),e(t,"moveTime",function(){return 2}),e(n,"skin",function(){return this._skin},function(t){this._skin=t}),e(t,"MaxEffect",function(){return 15}),e(t,"MinEffect",function(){return 5}),e(n,"BombRound",function(){return this._bombMaxRound}),e(t,"BombMinRound",function(){return 0}),e(t,"timeW",function(){return 511}),e(n,"getReward",function(){return this._reward}),n.getScoreColor=function(){var t;switch(this._skin){case 1:t=16777215;break;case 2:t=255;break;default:t=16777215}return t},n.getRewardColor=function(){var t;switch(this._skin){case 1:t=16777215;break;case 2:t=255;break;default:t=16777215}return t},e(t,"interval",function(){return this._interval||(this._interval=new t)}),t}();egret.registerClass(Config,"Config");var GameManage=function(t){function e(){t.call(this),this._status=GameStatus.NONE,this.init()}__extends(e,t);var i=__define,n=e,r=n.prototype;return r.init=function(){this._status=GameStatus.NONE,AnchorUtils.init(),TimerManager.init(),TweenManager.init(),StageUtils.stage.addEventListener(egret.Event.RESIZE,GameSence.interval.onResize,this),this._status=GameStatus.LOADING,this.configInit();var t=LoadRes.interval;this.addChild(t),t.addEventListener(SceneEvent.resourceComplate,GameSence.interval.init,GameSence.interval)},r.configInit=function(){Config.interval.init()},r.removeLoadUi=function(){LoadRes.interval.removeEventListener(SceneEvent.resourceComplate,GameSence.interval.init,GameSence.interval),this._status=GameStatus.Start,this.removeChild(LoadRes.interval)},r.update=function(t,e){var i=this;void 0===t&&(t=!1),void 0===e&&(e=1),t&&Bomb.interval.update(),TimerManager.doTimer(e+Config.removeTime,1,function(){Bomb.interval.minRound()<=Config.BombMinRound?(i.status=GameStatus.OVER,GameUi.GameOver.interval.init()):i.status=GameStatus.Start,Tile.interval.unSelect()},this)},r.setGameStatus=function(t){this._status=t},r.addSence=function(t){this.addChild(t)},r.removeAll=function(){this.removeChildren()},i(r,"status",function(){return this._status},function(t){this._status=t}),r.saveGame=function(){for(var t=[],e=Tile.interval._tileList,i=0;i<e.length;i++){for(var n=[],r=0;r<e[i].length;r++)n.push({x:e[i][r].pos.x,y:e[i][r].pos.y,_effect:e[i][r].effect,_type:e[i][r].type});t.push(n)}localStorage.setItem("game_data",JSON.stringify(t)),localStorage.setItem("game_score",String(Score.interval.score)),localStorage.setItem("game_reward",JSON.stringify(Reward.interval._rewardArr))},r.readGameData=function(){return null==localStorage.getItem("game_data")?!1:!0},r.clearData=function(){localStorage.clear()},i(e,"interval",function(){return this._interval||(this._interval=new e)}),e}(egret.DisplayObjectContainer);egret.registerClass(GameManage,"GameManage");var GameStatus;!function(t){t[t.NONE=0]="NONE",t[t.LOADING=1]="LOADING",t[t.Start=2]="Start",t[t.Select=3]="Select",t[t.PAUSE=4]="PAUSE",t[t.OVER=5]="OVER",t[t.Remove=6]="Remove"}(GameStatus||(GameStatus={}));var GameSence=function(t){function e(){t.call(this)}__extends(e,t);var i=__define,n=e,r=n.prototype;return r.init=function(){var t=GameManage.interval;t.removeLoadUi(),t.addSence(this._topBg=DisplayUtils.createBitmap("bg_png")),AnchorUtils.setAnchorX(this._topBg,.5),t.addSence(this._grid=Grid.interval),AnchorUtils.setAnchorX(this._grid,.5),AnchorUtils.setAnchorY(this._grid,1),t.addSence(this._border1=DisplayUtils.createBitmap("grid_border_right_png")),t.addSence(this._border2=DisplayUtils.createBitmap("grid_border_left_png")),AnchorUtils.setAnchor(this._border2,0),AnchorUtils.setAnchor(this._border1,0),t.addSence(this._timerBg=DisplayUtils.createBitmap("time_bg_png")),t.addSence(this._timer=DisplayUtils.createBitmap("time_progress_png")),this._timer.alpha=0,AnchorUtils.setAnchorX(this._timerBg,.5),t.addSence(this._buttom=DisplayUtils.createBitmap("chest_bg_png")),AnchorUtils.setAnchor(this._buttom,0),t.addSence(this._scoreBg=DisplayUtils.createBitmap("score_bg_png")),AnchorUtils.setAnchorX(this._scoreBg,.5),AnchorUtils.setAnchorY(this._scoreBg,1),t.addSence(this._scoreNumber=Score.interval),AnchorUtils.setAnchorX(this._scoreNumber,.5),AnchorUtils.setAnchorY(this._scoreNumber,1),this.onResize()},r.onResize=function(){var t=e.interval,i=StageUtils.stageW;StageUtils.stageH;t._topBg.x=i/2,t._grid.x=i/2,t._grid.y=1044,t._border1.x=i-25,t._border1.y=360,t._border2.x=0,t._border2.y=360,t._scoreBg.x=i/2,t._scoreBg.y=150,t._scoreNumber.x=this._scoreBg.x+5,t._scoreNumber.width=300,t._scoreNumber.y=this._scoreBg.y,t._timerBg.x=this._scoreBg.x,t._timerBg.y=291,t._timer.x=115,t._timer.y=313,t._buttom.x=25,t._buttom.y=t._grid.height+t._topBg.height+t._timerBg.height},r.DecTimer=function(t,e){void 0===e&&(e=!1),this._timer.alpha=1,this._timer.width=t},r.DecTimers=function(t){void 0===t&&(t=!1),this._timer.alpha=t?1:0,this._timer.width=Config.timeW},i(e,"interval",function(){return this._interval||(this._interval=new e)}),e}(egret.DisplayObjectContainer);egret.registerClass(GameSence,"GameSence");var GetGameConfig=function(t){function e(){t.call(this),this.init()}__extends(e,t);var i=(__define,e),n=i.prototype;return n.init=function(){var t=egret.getOption("id"),e=new egret.HttpRequest;e.responseType=egret.HttpResponseType.TEXT,e.open("http://127.0.0.2/diy_games/public/getGameConfig/"+t,egret.HttpMethod.GET),e.setRequestHeader("Content-Type","application/json"),e.send(),e.addEventListener(egret.Event.COMPLETE,this.onGetComplete,this),e.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onGetIOError,this),e.addEventListener(egret.ProgressEvent.PROGRESS,this.onGetProgress,this)},n.onGetComplete=function(t){var e=t.currentTarget,i=JSON.parse(e.response);Config.interval.skin=i.data.skin,Config.interval._grade=.1*i.data.grade,Config.interval._bombMaxRound=i.data.grade,Config.interval.reward=JSON.parse(i.data.reward),console.log(JSON.parse(i.data.reward),Config.interval.reward);var n=new SceneEvent(SceneEvent.GAME_CONFIG_GETED);this.dispatchEvent(n)},n.onGetIOError=function(t){console.log("get error : "+t)},n.onGetProgress=function(t){console.log("get progress : "+Math.floor(100*t.bytesLoaded/t.bytesTotal)+"%")},e}(egret.DisplayObject);egret.registerClass(GetGameConfig,"GetGameConfig");var LoadRes=function(t){function e(){t.call(this),this.width=0,this.height=20,this._resGroupCountInit=1,this._reGroupCountmax=6,this.getGameConfig(),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onResCommon,this),RES.loadConfig("resource/common.res.json","resource/")}__extends(e,t);var i=__define,n=e,r=n.prototype;return r.onResCommon=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onResCommon,this)},r.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),this.progressStart(),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceComplate,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onError,this),RES.loadGroup("gem"),RES.loadGroup("grid"),RES.loadGroup("effect"),RES.loadGroup("menu"),RES.loadGroup("bomb"),RES.loadGroup("over")},r.onResourceProgress=function(t){var e=100*Math.round(t.itemsLoaded/t.itemsTotal);this.loadBar.text="资源加载中："+String(e)+"%"},r.onError=function(t){console.log(t)},r.onResourceComplate=function(){if(this._resGroupCountInit++,this._resGroupCountInit>this._reGroupCountmax){var t=new SceneEvent(SceneEvent.resourceComplate);return void this.dispatchEvent(t)}},r.progressStart=function(){var t=new egret.Sprite;t.width=StageUtils.stageW,t.height=StageUtils.stageH,this.addChild(t),this.loadBar=new egret.TextField,this.loadBar.width=StageUtils.stageW,this.loadBar.height=StageUtils.stageH/2,this.loadBar.text="资源加载中：0%",this.loadBar.textAlign=egret.HorizontalAlign.CENTER,this.loadBar.verticalAlign=egret.VerticalAlign.BOTTOM,t.addChild(this.loadBar)},r.getGameConfig=function(){this._gGCMap=new GetGameConfig,this._gGCMap.addEventListener(SceneEvent.GAME_CONFIG_GETED,this.configGameComplate,this)},r.configGameComplate=function(){this._gGCMap.removeEventListener(SceneEvent.GAME_CONFIG_GETED,this.configGameComplate,this),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/skin_"+Config.interval.skin+".res.json","resource/")},i(e,"interval",function(){return this._interval||(this._interval=new e)}),e}(egret.Sprite);egret.registerClass(LoadRes,"LoadRes");var BitmapLabel=eui.BitmapLabel,Menu=function(t){function e(){t.call(this),this.init()}__extends(e,t);var i=__define,n=e,r=n.prototype;return r.init=function(){this.x=90,this.y=180;var t=0,e=200;GameManage.interval.readGameData()&&(t=1,e=300,this.y=120),this.startBtn=DisplayUtils.createBitmap("startBtn_png"),this.addChild(this.startBtn),this.startBtn.touchEnabled=!0,this.continuationBtn=DisplayUtils.createBitmap("continuationBtn_png"),this.continuationBtn.y=150,t&&this.addChild(this.continuationBtn),this.continuationBtn.touchEnabled=!0,this.gameHeadBtn=DisplayUtils.createBitmap("gameHeadBtn_png"),this.gameHeadBtn.y=e,this.addChild(this.gameHeadBtn),this.gameHeadBtn.touchEnabled=!0,this.addTouch()},r.addTouch=function(){this.startBtn.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onStartBtn,this),this.continuationBtn.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onContinuationBtn,this),this.gameHeadBtn.addEventListener(egret.TouchEvent.TOUCH_END,this.onGameHeadEnd,this)},r.removaAllBtnListen=function(){this.startBtn.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onStartBtn,this),this.continuationBtn.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onContinuationBtn,this),this.gameHeadBtn.removeEventListener(egret.TouchEvent.TOUCH_END,this.onGameHeadEnd,this)},r.onStartBtn=function(){this.removaAllBtnListen(),Grid.interval.initGrid(),this.rewardLay(),GameManage.interval.clearData()},r.onContinuationBtn=function(t){this.removaAllBtnListen(),Score.interval.setScore=Number(localStorage.getItem("game_score")),Grid.interval.initGrid(!0),this.rewardLay()},r.rewardLay=function(){var t=Reward.interval;t._con.removeChildren(),GameManage.interval.addSence(t._con),t.layout()},r.onGameHeadEnd=function(){this.removaAllBtnListen(),this.layMap=new GameUi.Layer,StageUtils.stage.addChild(this.layMap),this.gameHeadBitMap=DisplayUtils.createBitmap("game_head_png"),this.layMap.addChild(this.gameHeadBitMap),this.layMap.removeChild(this.layMap.maskMap),this.gameHeadBitMap.touchEnabled=!0,this.gameHeadBitMap.addEventListener(egret.TouchEvent.TOUCH_END,this.onGameHeadSence,this)},r.onGameHeadSence=function(t){StageUtils.stage.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onGameHeadSence,this),StageUtils.stage.removeChild(this.layMap.groupMap),StageUtils.stage.removeChild(this.layMap),this.addTouch()},i(e,"interval",function(){return this._interval||(this._interval=new e)}),e}(egret.Sprite);egret.registerClass(Menu,"Menu");var is=egret.is,Reward=function(){function t(){this._con=new egret.DisplayObjectContainer,this._rewardArr=[],this._conMap=[],this._bitMap=[]}var e=__define,i=t,n=i.prototype;return n.layout=function(){for(var t=Config.interval.getReward,e=0;e<t.length;e++){var i=this.createSprite(e,t[e].score);this._con.addChild(i),this._conMap.push(i);var n=new RewardMap(Number(t[e].score),t[e].url);this._rewardArr.push(n)}this._con.y=1050,this._con.width=StageUtils.stageW,this._con.x=StageUtils.stageW/(t.length+1)-20},n.createSprite=function(t,e){var i=new egret.Sprite,n=DisplayUtils.createBitmap("baoxiang_png");n.x=26+120*t,n.y=5,this._bitMap.push(n);var r=new egret.TextField;return r.text=e,r.size=20,r.y=65,r.x=5+120*t,r.width=120,r.height=70,r.textColor=Config.interval.getRewardColor(),r.textAlign="center",i.width=120,i.addChild(n),i.addChild(r),i},n.inspect=function(t){for(var e=0;e<this._rewardArr.length;e++)t>=this._rewardArr[e].score&&!this._rewardArr[e].isReceive&&(this._rewardArr[e].isReceive=!0,this.trigger(this._conMap[e]),this._bitMap[e].y-=4,this._bitMap[e].x-=23,this._bitMap[e].texture=RES.getRes("baoxiang_can_png"))},n.trigger=function(t){var e=this._conMap.indexOf(t);0>e||(this._conMap[e].touchEnabled=!0,this._conMap[e].addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouch,this))},n.onTouch=function(t){for(var e=t.target,i=0;i<this._rewardArr.length;i++)this._conMap[i].hashCode!=e.hashCode||(this._conMap[i].removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouch,this),this._bitMap[i].x+=25,this._bitMap[i].texture=RES.getRes("baoxianged_png"),GameManage.interval.saveGame(),window.location.href=this._rewardArr[i].url)},e(t,"interval",function(){return this._interval||(this._interval=new t)}),t}();egret.registerClass(Reward,"Reward");var RewardMap=function(){function t(t,e,i){void 0===i&&(i=!1),this.score=t,this.url=e,this.isReceive=i}var e=(__define,t);e.prototype;return t}();egret.registerClass(RewardMap,"RewardMap");var SceneEvent=function(t){function e(e,i,n){void 0===i&&(i=!1),void 0===n&&(n=!1),t.call(this,e,i,n)}__extends(e,t);var i=(__define,e);i.prototype;return e.resourceComplate="资源加载完成",e.startPlay="开始游戏",e.GAME_OVER="游戏结束",e.TOUCH_TILE="触摸方块",e.TOUCH_END="触摸方块结束",e.TILE_CREATE="创建方块",e.TILE_REMOVE="移除方块",e.TILE_SIGN="设置方块标记",e.TILE_CONNECT="方块相连",e.TILE_SELECT="选中方块",e.TILE_UNSELECT="取消选中方块",e.TILE_MOVE="方块移动",e.TILE_CHANGE_EFFECT="修改方块效果",e.TILE_CHANGE_TYPE="修改方块类型",e.GAME_CONFIG_GETED="获取游戏配置完成",e}(egret.Event);egret.registerClass(SceneEvent,"SceneEvent");var Score=function(t){function e(){t.call(this),this._score=0,this.init()}__extends(e,t);var i=__define,n=e,r=n.prototype;return r.init=function(){this._scoreTF=new egret.TextField,this._scoreTF.background=!1,this._scoreTF.backgroundColor=14588005,this._scoreTF.border=!1,this._scoreTF.fontFamily="Arial",this._scoreTF.textColor=Config.interval.getScoreColor(),this._scoreTF.size=40,this._scoreTF.textAlign="center",this._scoreTF.width=300,this._scoreTF.text=String(this._score),this.addChild(this._scoreTF),AnchorUtils.setAnchorY(this._scoreTF,1)},i(r,"score",function(){return this._score},function(t){t>4&&(t*=t-3),this._score+=t,this._scoreTF.text=String(this._score),Reward.interval.inspect(this._score)}),i(r,"setScore",void 0,function(t){this._score+=t,this._scoreTF.text=String(this._score)}),r.rest=function(){this._score=0,this.score=0},i(e,"interval",function(){return this._interval||(this._interval=new e)}),e}(egret.DisplayObjectContainer);egret.registerClass(Score,"Score");var Arrow=function(t){function e(){t.call(this),this._arrows=[]}__extends(e,t);var i=__define,n=e,r=n.prototype;return r.destroy=function(){DisplayUtils.removeFromParent(this),ObjectPool.push(this)},r.addArrow=function(t,e,i,n){var r=DisplayUtils.createBitmap("arrow_png");this.scaleX=this.scaleY=.7,AnchorUtils.setAnchor(this,.5),r.x=(t+i)/2,r.y=(e+n)/2,r.rotation=MathUtils.getAngle(MathUtils.getRadian2(t,e,i,n)),this.addChild(r),this._arrows.push(r)},r.delArrow=function(){this._arrows.length},i(e,"interval",function(){return this._interval||(this._interval=new e)}),e}(egret.DisplayObjectContainer);egret.registerClass(Arrow,"Arrow");var Bomb=function(){function t(){this._posArr=[],this._bombArr=[],this._config=Config.interval}var e=__define,i=t,n=i.prototype;return n.add=function(t,e){this._posArr.push(String(t)+String(e)),this._bombArr.push(this._config.BombRound),this.minRound()},n.isBomb=function(t){return this._posArr.indexOf(t)>=0},n.moveBomb=function(t,e){var i=this._posArr.indexOf(String(t.x)+t.y);this._posArr[i]=String(e.x)+e.y},n.removeBomb=function(t){var e=this._posArr.indexOf(String(t.x)+String(t.y));this._posArr.splice(e,1),this._bombArr.splice(e,1)},n.update=function(){if(!(this._bombArr.length<1))for(var t=0;t<this._bombArr.length;t++)this._bombArr[t]--},n.minRound=function(){if(this._bombArr.length<1)return GameSence.interval.DecTimers(),this._config.BombRound;for(var t=this._bombArr[0],e=0;e<this._bombArr.length;e++)t=Math.min(this._bombArr[e],t);return this._bombArr.length>=1&&GameSence.interval.DecTimer(t*(Config.timeW/this._config.BombRound)),t},n.getMinIndex=function(){for(var t=this._bombArr[0],e=0;e<this._bombArr.length;e++)t=Math.min(this._bombArr[e],t);var i=this._bombArr.indexOf(t),n=this._posArr[i].substr(0,1),r=this._posArr[i].substr(1,1);return new Vector2(Number(n),Number(r))},n.rest=function(){this._bombArr=[],this._posArr=[]},e(t,"interval",function(){return this._interval||(this._interval=new t)}),t}();egret.registerClass(Bomb,"Bomb");var BombEnum;!function(t){t[t.x=0]="x",t[t.y=1]="y",t[t.round=2]="round"}(BombEnum||(BombEnum={}));var Effect=function(t){function e(){t.call(this),this.x=Grid.interval.width/2,this.y=Grid.interval.height/2,this.width=Grid.interval.width,this.height=Grid.interval.height,this.hashCodes=[],this.targets=[]}__extends(e,t);var i=__define,n=e,r=n.prototype;return r.play=function(t,e,i){void 0===i&&(i="");var n=this.isCode(e.$hashCode);return n>=0?void this.move(n,e.pos.x,e.pos.y):void this.init(t,e,i)},r.move=function(t,e,i){var n=this.getTruePosition(e,i);this.targets[t].x=n.x,this.targets[t].y=n.y},r.init=function(t,e,i){void 0===i&&(i="");var n,r,s,o=RES.getRes(t+"_json"),a=RES.getRes(t+"_png"),h=this.getTruePosition(e.pos.x,e.pos.y);s=new egret.MovieClipDataFactory(o,a),i=""==i?t:i,n=s.generateMovieClipData(i),r=new egret.MovieClip(n),this.addChild(r),AnchorUtils.setAnchor(r,.5),r.play(-1),r.x=h.x,r.y=h.y,r.scaleX=.8,r.scaleY=.8,this.hashCodes.push(e.$hashCode),this.targets.push(r)},r.getTruePosition=function(t,e){var t=Config.gridBgW/2+Config.tileSize*(t-Config.interval.hor/2.16),e=Config.tileSize*(e+1/5.8)+5;return new Vector2(t,e)},r.remove=function(t){var e=this.isCode(t);e>=0&&this.removeChild(this.targets[e])},r.update=function(t,e,i){var n=this.isCode(t.$hashCode);if(!(0>n)){var r=this.getTruePosition(e.x2,e.y2),s=new Tween(this.targets[n]);s.to={x:r.x,y:r.y},s.duration=i,s.ease=TweenEase.BounceOut,s.start()}},r.isCode=function(t){return this.hashCodes.indexOf(t)},i(e,"interval",function(){return this._interval||(this._interval=new e)}),e}(egret.DisplayObjectContainer);egret.registerClass(Effect,"Effect");var EFFECT;!function(t){t[t.None=0]="None",t[t.Bomb=1]="Bomb",t[t.NineGrid=2]="NineGrid",t[t.AllCross=4]="AllCross",t[t.CrossX=5]="CrossX",t[t.CrossY=6]="CrossY",t[t.CrossXY=7]="CrossXY"}(EFFECT||(EFFECT={}));var GameUi;!function(t){var e=function(t){function e(){t.call(this),this.layerWidth=500,this.layerHeight=600,this.init()}__extends(e,t);var i=__define,n=e,r=n.prototype;return r.init=function(){StageUtils.stage.addChild(this),StageUtils.stage.addChild(this.groupMap=this.groupLayout()),this.maskMap=this.maskLayout(),this.titleMap=this.titleLayout(),this.contentMap=this.contentLayout(),this.btnGroupMap=this.btnGroupLayout()},r.maskLayout=function(){var t=new egret.Sprite;return t.graphics.beginFill(0,.8),t.graphics.drawRect(0,0,StageUtils.stage.stageWidth,StageUtils.stage.stageHeight),t.graphics.endFill(),this.addChild(t),t},r.groupLayout=function(){var t=new egret.Sprite;return t.x=(StageUtils.stage.stageWidth-this.layerWidth)/2,t.y=(StageUtils.stage.stageHeight-this.layerHeight)/2,t.width=this.layerWidth,t.height=this.layerHeight,t},r.titleLayout=function(){var t=new egret.Sprite;return t.height=30,t.width=this.groupMap.width-50,this.groupMap.addChild(t),t},r.closeLayer=function(){var t=new egret.Sprite;return this.groupMap.addChild(t),t},r.contentLayout=function(){var t=new egret.Sprite;return t.x=0,t.y=33,t.height=150,t.width=this.groupMap.width,this.groupMap.addChild(t),t},r.btnGroupLayout=function(){var t=new egret.Sprite;return t.y=this.groupMap.height-this.contentMap.height-this.titleMap.height,t.height=50,this.groupMap.addChild(t),t},i(e,"interval",function(){return this._interval||(this._interval=new this)}),e}(egret.DisplayObjectContainer);t.Layer=e,egret.registerClass(e,"GameUi.Layer");var i=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var i=(__define,e);i.prototype;return e}(egret.DisplayObjectContainer);t.Load=i,egret.registerClass(i,"GameUi.Load");var n=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var i=(__define,e);i.prototype;return e}(egret.DisplayObjectContainer);t.Menu=n,egret.registerClass(n,"GameUi.Menu");var r=function(){function e(){}var i=__define,n=e,r=n.prototype;return r.init=function(){GameManage.interval.clearData(),this.layerMap=new t.Layer;var e=DisplayUtils.createBitmap("game_over_png"),i=Bomb.interval.getMinIndex(),n=(Tile.interval.getTruePosition(i.x,i.y),Tile.interval.findTile(i));n.$hashCode;e.x=n.x-10,e.y=n.y+320,e.scaleY=1,e.scaleX=1,this.layerMap.addChild(e);var r=new Tween(e);r.to={x:StageUtils.stageW/2.5,y:StageUtils.stageH/2};var s=(StageUtils.stageW/2.5-e.x)*(StageUtils.stageW/2.5-e.x)+(StageUtils.stageH/2.5-e.y)*(StageUtils.stageH/2.5-e.y);r.duration=4*Math.sqrt(s);var o=this;r.callBack=function(){o.content()},r.start()},r.content=function(){var t,e,i="game_over_am",n=RES.getRes(i+"_json"),r=RES.getRes(i+"_png");e=new egret.MovieClipDataFactory(n,r),t=e.generateMovieClipData("gameOver"),this.mc=new egret.MovieClip(t),this.layerMap.contentMap.addChild(this.mc),AnchorUtils.setAnchor(this.mc,.5),this.mc.play(1),this.mc.scaleX=.8,this.layerMap.groupMap.y+=80,this.mc.scaleY=.8,this.mc.addEventListener(egret.Event.COMPLETE,this.tipsText,this)},r.tipsText=function(t){this.mc.removeEventListener(egret.Event.COMPLETE,this.tipsText,this);var e=new egret.TextField;e.text="点击屏幕重新开始",e.textColor=16777215,e.width=500,e.height=70,e.fontFamily="Arial",e.textAlign=egret.HorizontalAlign.CENTER,this.layerMap.btnGroupMap.y+=100,this.layerMap.btnGroupMap.addChild(e),this.layerMap.maskMap.touchEnabled=!0,this.layerMap.maskMap.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRestart,this)},r.onRestart=function(t){this.layerMap.maskMap.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onRestart,this),Score.interval.rest(),StageUtils.stage.removeChild(this.layerMap.groupMap),StageUtils.stage.removeChild(this.layerMap),GameManage.interval.status=GameStatus.Start,Tile.interval._tileCon.removeChildren(),Effect.interval.removeChildren(),Bomb.interval.rest(),Grid.interval.removeChildren(),Grid.interval.init();var e=Reward.interval;e._con.removeChildren(),GameManage.interval.addSence(e._con)},i(e,"interval",function(){return this._interval||(this._interval=new e)}),e}();t.GameOver=r,egret.registerClass(r,"GameUi.GameOver")}(GameUi||(GameUi={}));var Grid=function(t){function e(){t.call(this),this._config=Config.interval,this.init()}__extends(e,t);var i=__define,n=e,r=n.prototype;return r.init=function(){this.addChild(this._bg=DisplayUtils.createBitmap("gridBg_png")),this.width=this._bg.width=Config.gridBgW,this.height=this._bg.height=Config.gridBgH,this.addChild(this._gridCon=new egret.DisplayObjectContainer),this.addChild(this._menuGroup=new Menu),this.touchEnabled=!0,this._touchStatus=TouchStatus.None},r.initGrid=function(t){void 0===t&&(t=!1),this.removeChild(this._menuGroup);for(var e=0;e<this.hor;e++)for(var i=0;i<this.ver;i++){var n=this.getTruePosition(e,i),r=DisplayUtils.createBitmap("gem_bg_png");AnchorUtils.setAnchorX(r,.2),AnchorUtils.setAnchorY(r,.5),r.x=n.x,r.y=n.y,r.width=Config.gridW,r.height=Config.gridH,this._gridCon.addChild(r)}var s=Tile.interval;t?s.restartInit():s.initTileList(),this.addChild(s._tileCon),AnchorUtils.setAnchor(s,.5),this.addChild(Effect.interval),AnchorUtils.setAnchor(Effect.interval,.5),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this),this.addEventListener(egret.TouchEvent.TOUCH_END,s.touchEnd,s),this.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.touchReleaseOutside,this)},r.onTouchBegin=function(){return GameManage.interval.status==GameStatus.OVER?(this.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this),this.removeEventListener(egret.TouchEvent.TOUCH_END,Tile.interval.touchEnd,Tile.interval),void this.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.touchReleaseOutside,this)):void(this._touchStatus=TouchStatus.Start)},r.touchReleaseOutside=function(t){this._touchStatus==TouchStatus.Start&&this.dispatchEventWith(egret.TouchEvent.TOUCH_END)},r.getTruePosition=function(t,e){var t=this.width/2+this.tileSize*(t-this.hor/2+.25),e=this.tileSize*(e+1/2.2)+this.top;return new Vector2(t,e)},i(r,"hor",function(){return this._config.hor}),i(r,"ver",function(){return this._config.ver}),i(r,"tileSize",function(){return Config.tileSize}),i(r,"top",function(){return 5}),i(e,"interval",function(){return this._interval||(this._interval=new e)}),e}(egret.DisplayObjectContainer);egret.registerClass(Grid,"Grid");var TouchStatus;!function(t){t[t.None=0]="None",t[t.Start=1]="Start",t[t.End=2]="End"}(TouchStatus||(TouchStatus={}));var Tile=function(t){function e(){t.call(this),this._durationLastTime=100,this._issetEffect=!1,this._Config=Config.interval,this._hor=this._Config.hor,this._ver=this._Config.ver,this._selectArr=[],this._signTile=[],this._tileCon=new egret.DisplayObjectContainer,this._Config=Config.interval}__extends(e,t);var i=__define,n=e,r=n.prototype;return r.initTileList=function(){this._tileList=[];for(var t=0;t<this._hor;t++){var e=[];this._tileList.push(e);for(var i=0;i<this._ver;i++)e.push(this.create(t,i))}},r.restartInit=function(){this._tileList=[];for(var t=JSON.parse(localStorage.getItem("game_data")),e=0;e<t.length;e++){for(var i=[],n=0;n<t[e].length;n++){var r=this.getTruePosition(t[e][n].x,t[e][n].y),s=new TileBitmap;AnchorUtils.setAnchor(s,.5),s.x=r.x,s.y=r.y,s.width=66,s.height=68,s.pos=new Vector2(t[e][n].x,t[e][n].y),s.type=t[e][n]._type,s.effect=t[e][n]._effect,this.addTouch(s),this._tileCon.addChild(s),i.push(s)}this._tileList.push(i)}},r.create=function(t,e,i,n){void 0===i&&(i=null),void 0===n&&(n=0);var r=this.getTruePosition(t,e),s=new TileBitmap;return AnchorUtils.setAnchor(s,.5),s.x=r.x,s.y=r.y,s.width=66,s.height=68,s.pos=new Vector2(t,e),null!==i&&(s.type=n,s.effect=i),this.addTouch(s),this._tileCon.addChild(s),s},r.addTouch=function(t){t.touchEnabled=!0,t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.touchTile,this),t.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.touchTile,this)},r.removeTouch=function(t){t.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.touchTile,this),t.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.touchTile,this),t.removeEventListener(egret.TouchEvent.TOUCH_END,this.touchEnd,this)},r.touchTile=function(t){var e=t.target;if(this.isStatus(GameStatus.Start))e.effect!==EFFECT.AllCross&&this.getEffect(e),this.select(e),this.pushSelect(e),this.setIsEffect(!1),GameManage.interval.status=GameStatus.Select;else if(this.isStatus(GameStatus.Select)){var i=this._selectArr.length,n=this._selectArr[i-1],r=this._selectArr.indexOf(e);if(0>r&&i>0&&this.typeCompare(e,n)){if(n.type===Shape.QS&&1==i){if(e.effect===EFFECT.Bomb)return;this.effectQs(e.type)}else{if(this.isCross(e))return;this.getEffect(e)}this.select(e),this.pushSelect(e),this.signToSelect()}else r>-1&&(i-1>r?(this.deleteSelect(n),this.signToUnselect()):e.effect!==EFFECT.None&&this.signToSelect())}},r.typeCompare=function(t,e){return t.type===e.type||e.type==Shape.QS||t.type==Shape.QS},r.signToSelect=function(){if(!(this._signTile.length<1))for(var t=0;t<this._signTile.length;t++)this.select(this._signTile[t])},r.signToUnselect=function(){if(!(this._signTile.length<1))for(var t=0;t<this._signTile.length;t++)this._selectArr.indexOf(this._signTile[t])>-1||this._signTile[t].unselect()},r.isCross=function(t){var e=t.pos,i=this._selectArr.length,n=this._selectArr[i-1].pos;return Math.abs(e.x-n.x)>1?!0:Math.abs(e.y-n.y)>1?!0:!1},r.deleteSelect=function(t){var e=this._selectArr.indexOf(t);e>=0&&(this._selectArr.splice(e,1),t.unselect())},r.pushSelect=function(t){this._selectArr.indexOf(t)<0&&(this._selectArr.push(t),t.isSelect=!0)},r.touchEnd=function(t){Grid.interval._touchStatus===TouchStatus.Start&&(Grid.interval._touchStatus=TouchStatus.End,this.canRemove?(this.remove(),GameManage.interval.update(!0,this._durationLastTime)):(this.removeEffects(),GameManage.interval.update()))},r.touchEnds=function(t){this.canRemove&&(e.interval.remove(),GameManage.interval.update(!0,this._durationLastTime))},r.unSelect=function(){for(var t=0;t<this._selectArr.length;t++)this._selectArr[t].unselect(),this._selectArr[t]._sign=!1;this._selectArr=[]},i(r,"curSelectType",function(){for(var t=0,e=0;e<this._selectArr.length&&(t=this._selectArr[e].type,0==t);e++);return t}),i(r,"canRemove",function(){return this.isHaveQs()?!0:this._selectArr.length>=3}),r.isHaveQs=function(){for(var t=0;t<this._selectArr.length;t++)if(this._selectArr[t].effect===EFFECT.AllCross)return!0;return!1},r.getTilePos=function(t){return t.pos},r.getEffect=function(t){switch(t.effect){case EFFECT.NineGrid:for(var e=t.pos.x,i=t.pos.y,n=Math.max(0,e-1),r=Math.min(this._hor,e+2),s=Math.max(0,i-1),o=Math.min(this._ver,i+2),a=n;r>a;a++)for(var h=s;o>h;h++){var c=this._tileList[a][h];this._signTile.indexOf(c)>=0||(c._sign=!0,this._signTile.push(c),c.type>0&&this.getEffect(c))}this.setIsEffect();break;case EFFECT.CrossX:for(var a=0;a<this._hor;a++){var c=this._tileList[a][t.pos.y];this._signTile.indexOf(c)>=0||(c._sign=!0,this._signTile.push(c),c.type>0&&this.getEffect(c))}this.setIsEffect();break;case EFFECT.CrossY:for(var a=0;a<this._ver;a++){var c=this._tileList[t.pos.x][a];this._signTile.indexOf(c)>=0||(c._sign=!0,this._signTile.push(c),c.type>0&&this.getEffect(c))}this.setIsEffect();break;case EFFECT.CrossXY:for(var a=0;a<this._hor;a++){var u=this._tileList[a][t.pos.y];this._signTile.indexOf(u)>=0||(u._sign=!0,this._signTile.push(u),u.type>0&&this.getEffect(u))}for(var a=0;a<this._ver;a++){var l=this._tileList[t.pos.x][a];this._signTile.indexOf(l)>=0||(this._signTile.push(l),l._sign=!0,l.type>0&&this.getEffect(l))}this.setIsEffect();break;case EFFECT.AllCross:this.effectQs(this._selectArr[this._selectArr.length-1].type)}},r.effectQs=function(t){for(var e=0;e<this._hor;e++)for(var i=0;i<this._ver;i++){var n=this._tileList[e][i];this._signTile.indexOf(n)>=0||(n.type==t||n.effect==EFFECT.Bomb)&&(this._signTile.push(n),n._sign=!0,this.getEffect(n))}this.setIsEffect()},r.setIsEffect=function(t){void 0===t&&(t=!0),this._issetEffect&&t||(this._issetEffect=t)},r.removeEffects=function(){var t=this._signTile.length;if(!(1>t)){for(var e=0;t>e;e++)this._selectArr.pop(),this._signTile[e].unselect();this._signTile=[]}},r.remove=function(){var t=this;if(this.isStatus(GameStatus.Select)){GameManage.interval.status=GameStatus.Remove,this._removeTile=[];for(var e=Config.removeTime,i=this._selectArr.length,n=this,r=0;i>r;r++){var s=this.getTilePos(this._selectArr[r]),o=new Tween(this._tileList[s.x][s.y]);n._removeTile.push(this._selectArr[r]),o.to={scaleX:.2,scaleY:.2},o.duration=e,o.start()}this._selectArr[i-1].pos.clone();TimerManager.doTimer(e+Config.anInterval,1,function(){t.removeTile(),t.removeEffects(),t.repair()},this),GameManage.interval.status=GameStatus.Start}},r.removeTile=function(){var t,e=this.mermgRemoveTile(),i=e.length,n=i,r=RandomUtils.limitInteger(0,i-2),s=e[r];if(!(1>i)){for(var o=0;i>o;o++){this.removeTouch(e[o]);var a=e[o].pos;this._tileList[a.x][a.y]=new TileBitmap,this._tileList[a.x][a.y].x=1,this._tileList[a.x][a.y].pos=new Vector2(a.x,a.y),e[o].effect==EFFECT.Bomb&&(Bomb.interval.removeBomb(a),n--),this._tileCon.removeChild(e[o]),this.removeEffect(e[o])
}this.createBomb(s.pos.x,s.pos.y),Score.interval.score=n,i=this._selectArr.length;var h=this._selectArr[i-1];this._removeTile=[],i<Config.MinEffect||(i>=Config.MinEffect&&i<Config.MaxEffect?t=h.type:i>=Config.MaxEffect&&(t=Shape.QS),this._tileList[h.pos.x][h.pos.y]=this.create(h.pos.x,h.pos.y,i,t))}},r.createBomb=function(t,e){Math.random()<this._Config.grade||(this._tileList[t][e]=this.create(t,e,-1),Bomb.interval.add(t,e))},r.mermgRemoveTile=function(){var t=this._removeTile,e=this._signTile.length;if(e>0)for(var i=0;e>i;i++)t.indexOf(this._signTile[i])>=0||t.push(this._signTile[i]);return t},r.removeEffect=function(t){t.effect>0&&Effect.interval.remove(t.$hashCode)},r.repair=function(){for(var t=[],e=[],i=0;i<this._hor;i++){var n=[];t.push(n);for(var r=0;r<this._ver;r++)1==this._tileList[i][r].x&&n.push(r)}for(var i=0;i<t.length;i++){var s=t[i];s.sort(SortUtils.sortNum);for(var o=0;o<s.length;o++){var a=new Vector2(i,o-s.length),h=new Vector2(i,o);e.push(new moveInfo(a,h))}for(var r=0;r<this._ver;r++)if(r<s[0])e.push(new moveInfo(new Vector2(i,r),new Vector2(i,r+s.length)));else if(s.shift(),0==s.length)break}this._durationTime=0,this.updates(e)},r.updates=function(t){for(var e=t.length-1;e>=0;e--){var i=t[e],n=this.getTruePosition(i.x2,i.y2),r=Math.abs(i.y1-i.y2)*Config.anInterval+Config.moveTime;if(this._durationTime=Math.max(this._durationTime,r),this._durationLastTime=Math.max(this._durationLastTime,this._durationTime),i.y1>=0){var s=this.findTile(new Vector2(i.x1,i.y1));if(!s)continue}else var s=this.create(i.x1,i.y1);s.effect==EFFECT.Bomb&&Bomb.interval.moveBomb(s.pos,new Vector2(i.x2,i.y2));var o=(this._selectArr.length,new Tween(s));this._tileList[i.x2][i.y2]=s,this._tileList[i.x2][i.y2].pos=new Vector2(i.x2,i.y2),o.to={x:n.x,y:n.y},o.duration=this._durationLastTime,o.ease=TweenEase.BounceOut,o.start(),Effect.interval.update(s,i,this._durationLastTime)}},r.findTile=function(t){for(var e=0;e<this._tileCon.numChildren;e++){var i=this._tileCon.getChildAt(e);if(i.pos.equalTo(t))return i}},r.select=function(t,e){if(void 0===e&&(e=!1),t.status=e?Status.Connect:Status.Selceted,!t.isSelect){var i=new Tween(t);i.from={rotation:170},i.to={rotation:0},i.ease=TweenEase.QuartOut,i.duration=400,i.start()}},r.isEffectDo=function(t){return t>=EFFECT.Bomb},r.statusSet=function(t,e){if(void 0===e&&(e=!1),e&&(GameManage.interval.status=GameStatus.Select),this._selectArr.push(t),this.canRemove)for(var i=0;i<this._selectArr.length;i++)this.select(this._selectArr[i],!0);else this.select(t)},r.isStatus=function(t){return GameManage.interval.status==t},r.getTruePosition=function(t,e){var t=Config.gridBgW/2+Config.tileSize*(t-this._hor/2+1/1.9),e=Config.tileSize*(e+1/2.2)+5;return new Vector2(t,e)},i(e,"interval",function(){return this._interval||(this._interval=new e)}),e}(egret.Sprite);egret.registerClass(Tile,"Tile");var moveInfo=function(){function t(t,e){this.x1=t.x,this.x2=e.x,this.y1=t.y,this.y2=e.y}var e=(__define,t);e.prototype;return t}();egret.registerClass(moveInfo,"moveInfo");var TileBitmap=function(t){function e(){t.call(this),this.status=Status.None,this._effect=EFFECT.None,this.isSelect=!1,this.type=this.randomType(),this._sign=!1}__extends(e,t);var i=__define,n=e,r=n.prototype;return r.unselect=function(){this.isSelect=!1,this.status!=Status.None&&(this.texture=RES.getRes("gem_"+this._type+"_png"),this.status=Status.None)},r.randomType=function(){return RandomUtils.limitInteger(1,4)},i(r,"status",function(){return this._status},function(t){this._status=t,this._status!=Status.None&&(this._status==Status.Selceted?this.texture=RES.getRes("gem_"+this._type+"_s_png"):this._status==Status.Connect&&(this.texture=RES.getRes("gem_"+this._type+"_l_png")))}),i(r,"isSelect",function(){return this._isSelect},function(t){this._isSelect=t}),i(r,"type",function(){return this._type},function(t){this._type=t,this.texture=RES.getRes("gem_"+t+"_png")}),i(r,"effect",function(){return this._effect},function(t){if(0!=t){if(-1==t){this._effect=1;var e=Effect.interval;e.play("bomb",this)}else{this._effect=this.setEffect(t);var e=Effect.interval;e.play(this.getAnimationType(),this,this.getDirection())}this._effect>=EFFECT.Bomb&&(this.alpha=0)}}),r.setEffect=function(t){var e;switch(t){case 5:e=EFFECT.NineGrid;break;case 6:e=Math.random()>.5?EFFECT.CrossY:EFFECT.CrossX;break;case 7:e=EFFECT.CrossXY;break;case 15:e=EFFECT.AllCross,this._type=5;break;default:e=EFFECT.None}return t>EFFECT.CrossXY&&t<Config.MaxEffect?e=EFFECT.CrossXY:t>Config.MaxEffect&&(e=EFFECT.AllCross),e},r.getDirection=function(){var t,e=this._effect;switch(e){case EFFECT.NineGrid:t="sd";break;case EFFECT.CrossX:t="hp";break;case EFFECT.CrossY:t="sp";break;case EFFECT.CrossXY:t="sz";break;case EFFECT.AllCross:t="qs";break;default:t=""}return t},r.getAnimationType=function(){var t,e=this._type;switch(e){case Shape.YX:t="yx";break;case Shape.LX:t="lx";break;case Shape.ZFX:t="zfx";break;case Shape.DX:t="dx";break;case Shape.QS:t="qs";break;default:t="qs"}return this._effect==EFFECT.AllCross&&(t="qs"),t},i(r,"pos",function(){return this._pos},function(t){this._pos=t}),e}(egret.Bitmap);egret.registerClass(TileBitmap,"TileBitmap");var Status;!function(t){t[t.None=0]="None",t[t.Selceted=1]="Selceted",t[t.Connect=2]="Connect"}(Status||(Status={}));var Shape;!function(t){t[t.YX=1]="YX",t[t.LX=2]="LX",t[t.ZFX=3]="ZFX",t[t.DX=4]="DX",t[t.QS=5]="QS"}(Shape||(Shape={}));var Vector2=function(){function t(t,e){this.x=t,this.y=e}var e=(__define,t),i=e.prototype;return i.clone=function(){return new t(this.x,this.y)},i.equalTo=function(t){return t.x==this.x&&t.y==this.y?!0:!1},i.borderUpon=function(t){return Math.abs(t.x-this.x)<=1&&Math.abs(t.y-this.y)<=1?!0:!1},t}();egret.registerClass(Vector2,"Vector2");var Main=function(t){function e(){t.call(this),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.onAddToStage=function(){StageUtils.stage.addChild(GameManage.interval)},e}(egret.DisplayObjectContainer);egret.registerClass(Main,"Main");var AnchorUtils=function(){function t(){}var e=(__define,t);e.prototype;return t.init=function(){this._propertyChange=Object.create(null),this._anchorChange=Object.create(null),this.injectAnchor()},t.setAnchorX=function(t,e){t.anchorX=e},t.setAnchorY=function(t,e){t.anchorY=e},t.setAnchor=function(t,e){t.anchorX=t.anchorY=e},t.getAnchor=function(t){return t.anchorX!=t.anchorY&&console.log("target's anchorX != anchorY"),t.anchorX||0},t.getAnchorY=function(t){return t.anchorY||0},t.getAnchorX=function(t){return t.anchorX||0},t.injectAnchor=function(){Object.defineProperty(egret.DisplayObject.prototype,"width",{get:function(){return this.$getWidth()},set:function(e){var i=this;this.$setWidth(e),t._propertyChange[this.hashCode]=!0,egret.callLater(function(){t.changeAnchor(i)},this)},enumerable:!0,configurable:!0}),Object.defineProperty(egret.DisplayObject.prototype,"height",{get:function(){return this.$getHeight()},set:function(e){var i=this;this.$setHeight(e),t._propertyChange[this.hashCode]=!0,egret.callLater(function(){t.changeAnchor(i)},this)},enumerable:!0,configurable:!0}),Object.defineProperty(egret.DisplayObject.prototype,"anchorX",{get:function(){return this._anchorX},set:function(e){var i=this;this._anchorX=e,t._propertyChange[this.hashCode]=!0,t._anchorChange[this.hashCode]=!0,egret.callLater(function(){t.changeAnchor(i)},this)},enumerable:!0,configurable:!0}),Object.defineProperty(egret.DisplayObject.prototype,"anchorY",{get:function(){return this._anchorY},set:function(e){var i=this;this._anchorY=e,t._propertyChange[this.hashCode]=!0,t._anchorChange[this.hashCode]=!0,egret.callLater(function(){t.changeAnchor(i)},this)},enumerable:!0,configurable:!0})},t.changeAnchor=function(t){this._propertyChange[t.hashCode]&&this._anchorChange[t.hashCode]&&(t.anchorOffsetX=t._anchorX*t.width,t.anchorOffsetY=t._anchorY*t.height,delete this._propertyChange[t.hashCode])},t}();egret.registerClass(AnchorUtils,"AnchorUtils");var GameUtil;!function(t){var e=function(t){function e(e,i,n){t.call(this),this.init(e,i,n)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.init=function(t,e,i){this.texture=t,this.$setX(e),this.$setY(i),this.setanchorOff(.5,.5)},n.setNewTexture=function(t){this.texture=t},n.setanchorOff=function(t,e){this.anchorOffsetX=this.$getWidth()*t,this.anchorOffsetY=this.$getHeight()*e},e}(egret.Bitmap);t.MyBitmap=e,egret.registerClass(e,"GameUtil.MyBitmap")}(GameUtil||(GameUtil={}));var GameUtil;!function(t){var e=function(t){function e(e,i,n,r,s){t.call(this,RES.getRes(e+"1_png"),r,s),this.currentNumber=1,this.countNumber=0,this.bLoopCount=0,this.endcallfun=null,this.thisObj=null,this.bpause=!1,this.textureName=e,this.totalNumber=i,this.frameRate=n}__extends(e,t);var i=(__define,e),n=i.prototype;return n.setLoop=function(t){0==t&&(t=1),this.bLoopCount=t-1},n.play=function(){this.intervaltag=egret.setInterval(this.run,this,this.frameRate)},n.run=function(){this.nextFrame()},n.pause=function(){this.bpause=!0},n.resume=function(){this.bpause=!1},n.stop=function(){egret.clearInterval(this.intervaltag)},n.nextFrame=function(){if(!this.bpause){if(this.currentNumber++,this.currentNumber>=this.totalNumber){if(this.currentNumber=1,0==this.bLoopCount)return this.stop(),null!=this.endcallfun&&this.endcallfun.apply(this.thisObj),void this.parent.removeChild(this);this.bLoopCount>0&&this.bLoopCount--}this.setNewTexture(RES.getRes(this.textureName+this.currentNumber+"_png"))}},n.setendcall=function(t,e){this.thisObj=e,this.endcallfun=t},e}(t.MyBitmap);t.Animation=e,egret.registerClass(e,"GameUtil.Animation")}(GameUtil||(GameUtil={}));var ArrayUtils=function(){function t(){}var e=(__define,t);e.prototype;return t.forEach=function(t,e,i){for(var n=0,r=t.length;r>n;n++)e.apply(i,[t[n]])},t.remove=function(t,e){var i=t.indexOf(e);t.splice(i,1)},t}();egret.registerClass(ArrayUtils,"ArrayUtils");var DateUtils=function(){function t(){}var e=(__define,t),i=e.prototype;return i.getFormatBySecond=function(t,e){void 0===e&&(e=1);var i="";switch(e){case 1:i=this.getFormatBySecond1(t);break;case 2:i=this.getFormatBySecond2(t);break;case 3:i=this.getFormatBySecond3(t);break;case 4:i=this.getFormatBySecond4(t);break;case 5:i=this.getFormatBySecond5(t)}return i},i.getFormatBySecond1=function(t){void 0===t&&(t=0);var e,i=Math.floor(t/3600);e=0==i?"00":10>i?"0"+i:""+i;var n,r,s=Math.floor((t-3600*i)/60),o=Math.floor((t-3600*i)%60);return n=0==s?"00":10>s?"0"+s:""+s,r=0==o?"00":10>o?"0"+o:""+o,e+":"+n+":"+r},i.getFormatBySecond3=function(t){void 0===t&&(t=0);var e,i,n=Math.floor(t/3600),r=Math.floor((t-3600*n)/60),s=Math.floor((t-3600*n)%60);return e=0==r?"00":10>r?"0"+r:""+r,i=0==s?"00":10>s?"0"+s:""+s,e+":"+i},i.getFormatBySecond2=function(t){var e=new Date(t),i=e.getFullYear(),n=e.getMonth()+1,r=e.getDate(),s=e.getHours(),o=e.getMinutes(),a=e.getSeconds();return i+"-"+n+"-"+r+" "+s+":"+o+":"+a},i.getFormatBySecond4=function(t){var e=Math.floor(t/3600);return e>0?e>24?Math.floor(e/24)+"天前":e+"小时前":Math.floor(t/60)+"分钟前"},i.getFormatBySecond5=function(t){var e=86400,i=3600,n=60,r=Math.floor(t/e),s=Math.floor(t%e/i),o=Math.floor((t-s*i)/n),a=Math.floor((t-s*i)%n),h="",c="",u="",l="";return t>0?0==r?(h="",0==s?(c="",0==o?(u="",l=0==a?"":10>a?"0"+a+"秒":""+a+"秒"):(u=""+o+"分",l=0==a?"":10>a?"0"+a+"秒":""+a+"秒",u+l)):(c=s+"小时",0==o?(u="",l=0==a?"":10>a?"0"+a+"秒":""+a+"秒"):(u=10>o?"0"+o+"分":""+o+"分",c+u))):(h=r+"天",c=0==s?"":10>s?"0"+s+"小时":""+s+"小时",h+c):""},t}();egret.registerClass(DateUtils,"DateUtils");var DebugUtils=function(){function t(){}var e=__define,i=t;i.prototype;return t.isOpen=function(t){this._isOpen=t},e(t,"isDebug",function(){return this._isOpen}),t.start=function(t){this._isOpen&&(this._startTimes[t]=egret.getTimer())},t.stop=function(t){if(!this._isOpen)return 0;if(!this._startTimes[t])return 0;var e=egret.getTimer()-this._startTimes[t];return e>this._threshold&&this.log(t+": "+e),e},t.setThreshold=function(t){this._threshold=t},t.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];this._isOpen&&(t[0]="[DebugLog]"+t[0],console.log.apply(console,t))},t._isOpen=!1,t._startTimes={},t._threshold=3,t}();egret.registerClass(DebugUtils,"DebugUtils");var DeviceUtils=function(){function t(){}var e=__define,i=t;i.prototype;return e(t,"IsHtml5",function(){return egret.Capabilities.runtimeType==egret.RuntimeType.WEB}),e(t,"IsNative",function(){return egret.Capabilities.runtimeType==egret.RuntimeType.NATIVE}),e(t,"IsMobile",function(){return egret.Capabilities.isMobile}),e(t,"IsPC",function(){return!egret.Capabilities.isMobile}),e(t,"IsQQBrowser",function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("MQQBrowser")}),e(t,"IsIEBrowser",function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("MSIE")}),e(t,"IsFirefoxBrowser",function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("Firefox")}),e(t,"IsChromeBrowser",function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("Chrome")}),e(t,"IsSafariBrowser",function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("Safari")}),e(t,"IsOperaBrowser",function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("Opera")}),t}();egret.registerClass(DeviceUtils,"DeviceUtils");var DisplayUtils=function(){function t(){}var e=(__define,t);e.prototype;return t.createBitmap=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},t.removeFromParent=function(t){null!=t.parent&&t.parent.removeChild(t)},t}();egret.registerClass(DisplayUtils,"DisplayUtils");var DrawUtils=function(){function t(){}var e=(__define,t);e.prototype;return t.drawRoundHexagon=function(t,e,i,n){var r=t.graphics;r.clear(),r.lineStyle(i,n),r.beginFill(n),e-=Math.ceil(i/2),r.moveTo(-e/2,-e*Math.sqrt(3)/2),r.lineTo(e/2,-e*Math.sqrt(3)/2),r.lineTo(e,0),r.lineTo(e/2,e*Math.sqrt(3)/2),r.lineTo(-e/2,e*Math.sqrt(3)/2),r.lineTo(-e,0),r.lineTo(-e/2,-e*Math.sqrt(3)/2),r.endFill()},t.drawRect=function(t,e,i,n){var r=t.graphics;r.clear(),r.beginFill(n),r.drawRect(0,0,e,i),r.endFill()},t.drawRoundRect=function(t,e,i,n,r,s){var o=t.graphics;o.clear(),o.beginFill(s),o.drawRoundRect(0,0,e,i,n,r),o.endFill()},t.drawHollowRect=function(t,e,i,n,r){var s=t.graphics;s.clear(),s.lineStyle(n,r),s.moveTo(n/2,n/2),s.lineTo(e+n/2,n/2),s.lineTo(e+n/2,i+n/2),s.lineTo(n/2,i+n/2),s.lineTo(n/2,n/2)},t.drawTriangle=function(t,e,i,n){var r=t.graphics;r.clear(),r.lineStyle(i,n);var s=function(t){return e*Math.cos((60*t+30)/180*Math.PI)},o=function(t){return e*Math.sin((60*t+30)/180*Math.PI)};r.moveTo(s(0),o(0)),r.lineTo(s(2),o(2)),r.lineTo(s(4),o(4)),r.lineTo(s(0),o(0))},t.drawStar=function(t,e,i,n){var r=t.graphics;r.clear(),r.lineStyle(i,n);var s=function(t){return e*Math.cos((72*t-18)/180*Math.PI)},o=function(t){return e*Math.sin((72*t-18)/180*Math.PI)};r.moveTo(s(0),o(0)),r.lineTo(s(2),o(2)),r.lineTo(s(4),o(4)),r.lineTo(s(1),o(1)),r.lineTo(s(3),o(3)),r.lineTo(s(0),o(0))},t.drawCross=function(t,e,i,n){var r=t.graphics;r.clear(),r.lineStyle(i,n),r.moveTo(-e/2,0),r.lineTo(e/2,0),r.moveTo(0,-e/2),r.lineTo(0,e/2)},t.drawMi=function(t,e,i,n){var r=t.graphics;r.clear(),r.lineStyle(i,n),r.moveTo(-e/2,0),r.lineTo(e/2,0),r.moveTo(0,-e/2),r.lineTo(0,e/2);var s=Math.sin(Math.PI/4);r.moveTo(e/2*-s,e/2*-s),r.lineTo(e/2*s,e/2*s),r.moveTo(e/2*-s,e/2*s),r.lineTo(e/2*s,e/2*-s)},t.drawCircle=function(t,e,i){var n=t.graphics;n.clear(),n.beginFill(i),n.drawCircle(0,0,e),n.endFill()},t.drawLine=function(t,e,i,n,r){var s=t.graphics;s.clear(),s.lineStyle(n,r),s.moveTo(e.x,e.y),s.lineTo(i.x,i.y),t.graphics.endFill()},t}();egret.registerClass(DrawUtils,"DrawUtils");var Utils=function(){function t(){}var e=(__define,t);e.prototype;return t.macIconShake=function(t,e){for(var i=[[20,300],[15,300],[10,300],[5,300]],n="egret.Tween.get("+t+")",r=0,s=i.length;s>r;r++)n+=".to({'y':"+e+"-"+i[r][0]+"}, "+i[r][1]+")",n+=".to({'y':"+e+"}, "+i[r][1]+")";return n+=";"},t.startFlicker=function(t,e){t.alpha=1,egret.Tween.get(t).to({alpha:0},e).to({alpha:1},e).call(this.startFlicker,this,[t])},t.stopFlicker=function(t){egret.Tween.removeTweens(t)},t}();egret.registerClass(Utils,"Utils");var FrameExecutor=function(){function t(t){this.delayFrame=t,this.frameDelay=new FrameDelay,this.functions=new Array}var e=(__define,t),i=e.prototype;return i.regist=function(t,e){this.functions.push([t,e])},i.execute=function(){if(this.functions.length){var t=this.functions.shift();t[0].call(t[1]),this.frameDelay.delayCall(this.delayFrame,this.execute,this)}},t}();egret.registerClass(FrameExecutor,"FrameExecutor");var FrameDelay=function(){function t(){}var e=(__define,t),i=e.prototype;return i.delayCall=function(t,e,i){this.func=e,this.thisObj=i,TimerManager.doFrame(t,1,this.listener_enterFrame,this)},i.listener_enterFrame=function(){this.func.call(this.thisObj)},t}();egret.registerClass(FrameDelay,"FrameDelay");var KeyboardUtils=function(){function t(){}var e=(__define,t);e.prototype;return t.init=function(){if(this.key_ups=new Array,this.key_downs=new Array,DeviceUtils.IsHtml5){var t=this;document.addEventListener("keyup",function(e){for(var i=0,n=t.key_ups.length;n>i;i++){var r=t.key_ups[i][0],s=t.key_ups[i][1];s?r.call(s,e.keyCode):r(e.keyCode)}}),document.addEventListener("keydown",function(e){for(var i=0,n=t.key_downs.length;n>i;i++){var r=t.key_downs[i][0],s=t.key_downs[i][1];s?r.call(s,e.keyCode):r(e.keyCode)}})}},t.addKeyUp=function(t,e){this.key_ups.push([t,e])},t.addKeyDown=function(t,e){this.key_downs.push([t,e])},t.removeKeyUp=function(t,e){for(var i=0;i<this.key_ups.length;i++)this.key_ups[i][0]==t&&this.key_ups[i][1]==e&&(this.key_ups.splice(i,1),i--)},t.removeKeyDown=function(t,e){for(var i=0;i<this.key_downs.length;i++)this.key_downs[i][0]==t&&this.key_downs[i][1]==e&&(this.key_downs.splice(i,1),i--)},t}();egret.registerClass(KeyboardUtils,"KeyboardUtils");var Keyboard=function(){function t(){}var e=(__define,t);e.prototype;return t.LEFT=37,t.RIGHT=39,t.UP=38,t.DOWN=40,t.W=87,t.A=65,t.S=83,t.D=68,t.J=74,t.K=75,t.L=76,t.U=85,t.I=73,t.O=79,t.P=80,t.SPACE=32,t}();egret.registerClass(Keyboard,"Keyboard");var Log=function(){function t(){}var e=(__define,t);e.prototype;return t.trace=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];DebugUtils.isDebug&&(t[0]="[DebugLog]"+t[0],console.log.apply(console,t))},t}();egret.registerClass(Log,"Log");var MathUtils=function(){function t(){}var e=(__define,t);e.prototype;return t.getAngle=function(t){return 180*t/Math.PI},t.getRadian=function(t){return Math.PI=t/180*Math.PI},t.getRadian2=function(t,e,i,n){var r=i-t,s=n-e;return Math.atan2(s,r)},t.getDistance=function(t,e,i,n){var r=i-t,s=n-e,o=r*r+s*s;return Math.sqrt(o)},t.log=function(t,e){for(var i=0;(e=Math.floor(e/t))>0;)i+=1;return i},t}();egret.registerClass(MathUtils,"MathUtils");var MazeUtils=function(){function t(){}var e=(__define,t);e.prototype;return t.findPath=function(t,e,i){for(this._openList=[],this._closeList=[],this._mazeList=t,this._openList.push(e);this._openList.length>0;){this._openList.sort(this.sortF);var n=this._openList.shift();this._closeList.push(n);for(var r=this.getAroundPoint(n),s=0;s<r.length;s++){var o=r[s];this.getInOpenList(o)?this.recalcPoint(n,o):this.addPoint(n,i,o)}if(this.getInOpenList(i))return this.getInOpenList(i)}return this.getInOpenList(i)?this.getInOpenList(i):void 0},t.sortF=function(t,e){return t.F-e.F},t.getInOpenList=function(t){for(var e=this._openList,i=0;i<e.length;i++){var n=e[i];if(n.X==t.X&&n.Y==t.Y)return n}},t.getInCloseList=function(t){for(var e=this._closeList,i=0;i<e.length;i++){var n=e[i];if(n.X==t.X&&n.Y==t.Y)return n}},t.getAroundPoint=function(t){for(var e=[],i=-1;1>=i;i++)for(var n=-1;1>=n;n++)if(0!=i||0!=n){var r=!1;if(t.X%2==0?(0==i||n>=0)&&(r=!0):(0==i||0>=n)&&(r=!0),r){var s=new Point(t.X+i,t.Y+n);this.canReach(s)&&e.push(s)}}return e},t.addPoint=function(t,e,i){i.parent=t,i.G=this.calcG(t,i),i.H=this.calcH(e,i),this._openList.push(i)},t.recalcPoint=function(t,e){var i=this.calcG(t,e);i<e.G&&(e.parent=t,e.G=i)},t.calcG=function(t,e){var i=e.parent?e.parent.G:0;return i+1},t.calcH=function(t,e){return Math.abs(t.X-e.X)+Math.abs(t.Y-e.Y)},t.canReach=function(t){var e=t.X,i=t.Y,n=this._mazeList;return!this.getInCloseList(t)&&e>=0&&n.length>e&&i>=0&&n[e].length>i&&0==n[e][i]},t}();egret.registerClass(MazeUtils,"MazeUtils");var Point=function(){function t(t,e){this.G=0,this.H=0,this.X=t,this.Y=e}var e=__define,i=t,n=i.prototype;return e(n,"F",function(){return this.G+this.H}),t}();egret.registerClass(Point,"Point");var ObjectPool=function(){function t(){}var e=(__define,t);e.prototype;return t.pop=function(e){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];t._content[e]||(t._content[e]=[]);var r=t._content[e];if(r.length)return r.pop();var s,o=egret.getDefinitionByName(e),a=i.length;return 0==a?s=new o:1==a?s=new o(i[0]):2==a?s=new o(i[0],i[1]):3==a?s=new o(i[0],i[1],i[2]):4==a?s=new o(i[0],i[1],i[2],i[3]):5==a&&(s=new o(i[0],i[1],i[2],i[3],i[4])),s.ObjectPoolKey=e,s},t.popWithExtraKey=function(e,i){t._content[e]||(t._content[e]=[]);var n,r=t._content[e];if(r.length)for(var s=0;s<r.length;s++)if(r[s].extraKey==i){n=r[s],r.splice(s,1);break}if(!n){var o=egret.getDefinitionByName(e);n=new o(i),n.extraKey=i,n.ObjectPoolKey=e}return n},t.push=function(e){if(null==e)return!1;var i=e.ObjectPoolKey,n=t._content[i];return!n||n.indexOf(e)>=0?!1:(t._content[i].push(e),!0)},t.clear=function(){t._content={}},t.clearClass=function(e,i){void 0===i&&(i=null);for(var n=t._content[e];n&&n.length;){var r=n.pop();i&&r[i](),r=null}t._content[e]=null,delete t._content[e]},t.dealFunc=function(e,i){var n=t._content[e];if(null!=n){var r=0,s=n.length;for(r;s>r;r++)n[r][i]()}},t._content={},t}();egret.registerClass(ObjectPool,"ObjectPool");var RandomUtils=function(){function t(){}var e=(__define,t);e.prototype;return t.limit=function(t,e){t=Math.min(t,e),e=Math.max(t,e);var i=e-t;return t+Math.random()*i},t.limitInteger=function(t,e){return Math.floor(this.limit(t,e+1))},t.randomArray=function(t){var e=Math.floor(Math.random()*t.length);return t[e]},t}();egret.registerClass(RandomUtils,"RandomUtils");var Rocker=function(){function t(){}var e=(__define,t),i=e.prototype;return i.init=function(t,e,i,n){this.keys=[0,0],this.mouseX=-1,this.mouseY=-1,this.moveFlag=e,this.moveFlagX=e.x,this.moveFlagY=e.y,this.moveFlagGoX=this.moveFlagX,this.moveFlagGoY=this.moveFlagY,this.moveFlagWidthHelf=.5*t.width,this.moveFlagRec=new egret.Rectangle(this.moveFlagX-.5*t.width,this.moveFlagY-.5*t.height,t.width,t.height),this.moveFlagCheckRec=new egret.Rectangle(0,0,.5*StageUtils.stageW,StageUtils.stageH),this.dealKeyFunc=i,this.dealKeyTarget=n,this.moveFlag.touchEnabled=!0,this.moveFlag.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.startMove,this),this.moveFlag.addEventListener(egret.TouchEvent.TOUCH_END,this.stopMove,this),this.moveFlag.addEventListener(egret.TouchEvent.TOUCH_TAP,this.stopEvent,this),StageUtils.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.leaveStateEvent,this),StageUtils.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.heroMoveEvent,this),KeyboardUtils.addKeyDown(this.onKeyDown,this),KeyboardUtils.addKeyUp(this.onKeyUp,this)},i.onKeyDown=function(t){switch(t){case Keyboard.A:this.keys[0]=-1,this.startCheckKey();break;case Keyboard.D:this.keys[0]=1,this.startCheckKey();break;case Keyboard.W:this.keys[1]=-1,this.startCheckKey();break;case Keyboard.S:this.keys[1]=1,this.startCheckKey()}},i.onKeyUp=function(t){switch(t){case Keyboard.A:-1==this.keys[0]&&(this.keys[0]=0);break;case Keyboard.D:1==this.keys[0]&&(this.keys[0]=0);break;case Keyboard.W:-1==this.keys[1]&&(this.keys[1]=0);break;case Keyboard.S:1==this.keys[1]&&(this.keys[1]=0)}},i.stopEvent=function(t){t.stopPropagation()},i.leaveStateEvent=function(t){t.stageX==this.mouseX&&t.stageY==this.mouseY&&this.stopMove()},i.startMove=function(t){this.isMoveing=!0,this.moveFlagGoX=this.moveFlagX,this.moveFlagGoY=this.moveFlagY,this.mouseX=t.stageX,this.mouseY=t.stageY},i.stopMove=function(){this.isMoveing=!1,this.keys[0]=0,this.keys[1]=0,this.moveFlagGoX=this.moveFlagX,this.moveFlagGoY=this.moveFlagY,this.mouseX=-1,this.mouseY=-1},i.resetRockerPos=function(){this.moveFlag.x=this.moveFlagX,this.moveFlag.y=this.moveFlagY},i.heroMoveEvent=function(t){this.runMove(t.stageX,t.stageY)},i.runMove=function(t,e){if(this.isMoveing&&(this.moveFlagCheckRec.contains(t,e)||!(Math.abs(this.mouseX-t)>50||Math.abs(this.mouseY-e)>50))){if(this.mouseX=t,this.mouseY=e,this.moveFlagRec.contains(this.mouseX,this.mouseY))this.moveFlagGoX=this.mouseX,this.moveFlagGoY=this.mouseY;else{var i=MathUtils.getRadian2(this.moveFlagX,this.moveFlagY,this.mouseX,this.mouseY);this.moveFlagGoX=this.moveFlagX+Math.cos(i)*this.moveFlagWidthHelf,this.moveFlagGoY=this.moveFlagY+Math.sin(i)*this.moveFlagWidthHelf}this.moveFlagGoX>this.moveFlagX&&Math.abs(this.moveFlagGoX-this.moveFlagX)>10?this.keys[0]=1:this.moveFlagGoX<this.moveFlagX&&Math.abs(this.moveFlagGoX-this.moveFlagX)>10?this.keys[0]=-1:this.keys[0]=0,this.moveFlagGoY>this.moveFlagY&&Math.abs(this.moveFlagGoY-this.moveFlagY)>10?this.keys[1]=1:this.moveFlagGoY<this.moveFlagY&&Math.abs(this.moveFlagGoY-this.moveFlagY)>10?this.keys[1]=-1:this.keys[1]=0,this.startCheckKey()}},i.startCheckKey=function(){this.checkKeying||(this.checkKeying=!0,TimerManager.doFrame(1,0,this.delKeys,this))},i.stopCheckKey=function(){this.keys[0]=0,this.keys[1]=0,this.checkKeying&&(TimerManager.remove(this.delKeys,this),this.checkKeying=!1)},i.delKeys=function(){-1==this.mouseX||this.moveFlagCheckRec.contains(this.mouseX,this.mouseY)||this.stopMove(),this.moveFlag.x!=this.moveFlagGoX&&(this.moveFlag.x=this.moveFlagGoX),this.moveFlag.y!=this.moveFlagGoY&&(this.moveFlag.y=this.moveFlagGoY),this.keys[0]||this.keys[1]||this.stopCheckKey(),this.dealKeyFunc.call(this.dealKeyTarget,this.keys[0],this.keys[1])||this.resetRockerPos()},i.stop=function(){this.stopCheckKey(),this.stopMove()},t}();egret.registerClass(Rocker,"Rocker");var ShockUtils=function(){function t(){}var e=__define,i=t;i.prototype;return t.destroy=function(){this.stop()},t.shock=function(t,e,i){void 0===t&&(t=0),void 0===e&&(e=null),void 0===i&&(i=3),this._target||(this._type=t,this._target=e,this._type==this.MAP?(this._shockPoss=this.mapPoss.concat(),this._shockLength=this._shockPoss.length):this._type==this.SPRITE&&(this._shockPoss=this.spritePoss.concat(),this._shockLength=this._shockPoss.length),this.start(i))},t.start=function(t){void 0===t&&(t=1),this.repeatCount=t,this._shockCount=0,this._target&&(this._type!=this.MAP&&(this._rx=this._target.x),this._ry=this._target.y,TimerManager.doFrame(1,0,this.onShockEnter,this))},t.stop=function(){this._target&&(this._type!=this.MAP&&(this._target.x=this._rx),this._target.y=this._ry,TimerManager.remove(this.onShockEnter,this)),this._target=null},t.onShockEnter=function(t){var e=this._shockLength*this._repeatCount;if(this._shockCount>=e)return void this.stop();var i=this._shockCount%this._shockLength,n=this._shockPoss[i];this._target&&(this._type!=this.MAP&&(this._target.x=this._rx+n.x),this._target.y=this._ry+n.y),this._shockCount++},e(t,"repeatCount",function(){return this._repeatCount},function(t){this._repeatCount=t}),t.MAP=0,t.SPRITE=1,t.mapPoss=[new egret.Point(0,3),new egret.Point(0,0),new egret.Point(0,-2)],t.spritePoss=[new egret.Point(5,0),new egret.Point(-5,0),new egret.Point(5,0)],t._shockLength=0,t._shockCount=0,t._rx=0,t._ry=0,t._type=0,t._repeatCount=0,t}();egret.registerClass(ShockUtils,"ShockUtils");var SortUtils=function(){function t(){}var e=(__define,t);e.prototype;return t.sortNum=function(t,e){return t-e},t.random=function(t,e){return Math.random()-.5},t}();egret.registerClass(SortUtils,"SortUtils");var StageUtils=function(){function t(){}var e=__define,i=t;i.prototype;return e(t,"stage",function(){return egret.MainContext.instance.stage}),e(t,"stageW",function(){return egret.MainContext.instance.stage.stageWidth}),e(t,"stageH",function(){return egret.MainContext.instance.stage.stageHeight}),t}();egret.registerClass(StageUtils,"StageUtils");var StringUtils=function(){function t(){}var e=(__define,t);e.prototype;return t.trimSpace=function(t){return t.replace(/^\s*(.*?)[\s\n]*$/g,"$1")},t.getStringLength=function(t){for(var e=t.split(""),i=0,n=0;n<e.length;n++){var r=e[n];i+=this.isChinese(r)?2:1}return i},t.isChinese=function(t){var e=/^.*[\u4E00-\u9FA5]+.*$/;return e.test(t)},t}();egret.registerClass(StringUtils,"StringUtils");var TextFlowMaker=function(){function t(){}var e=(__define,t);e.prototype;return t.generateTextFlow=function(t){for(var e=t.split("|"),i=[],n=0,r=e.length;r>n;n++)i.push(this.getSingleTextFlow(e[n]));return i},t.getSingleTextFlow=function(t){for(var e,i=t.split("&"),n={style:{}},r=0,s=i.length;s>r;r++)e=i[r].split(":"),e[0]==this.PROP_TEXT?n.text=e[1]:e[0]==this.STYLE_SIZE?n.style.size=parseInt(e[1]):e[0]==this.STYLE_COLOR?n.style.textColor=parseInt(e[1]):n.text=e[0];return n},t.STYLE_COLOR="C",t.STYLE_SIZE="S",t.PROP_TEXT="T",t}();egret.registerClass(TextFlowMaker,"TextFlowMaker");var TimerManager=function(){function t(){}var e=__define,i=t;i.prototype;return t.init=function(){this._handlers=new Array,this._delHandlers=new Array,this._currTime=egret.getTimer(),this._currFrame=0,this._count=0,this._timeScale=1,egret.Ticker.getInstance().register(this.onEnterFrame,this)},t.setTimeScale=function(t){this._timeScale=t},t.onEnterFrame=function(){this._currFrame++,this._currTime=egret.getTimer(),DebugUtils.start("TimerManager:");for(var t=0;t<this._count;t++){var e=this._handlers[t],i=e.userFrame?this._currFrame:this._currTime;i>=e.exeTime&&(DebugUtils.start(e.method.toString()),e.method.call(e.methodObj,(this._currTime-e.dealTime)*this._timeScale),DebugUtils.stop(e.method.toString()),e.dealTime=this._currTime,e.exeTime+=e.delay,e.repeat||(e.repeatCount>1?e.repeatCount--:(e.complateMethod&&e.complateMethod.apply(e.complateMethodObj),this._delHandlers.push(e))))}for(;this._delHandlers.length;){var e=this._delHandlers.pop();this.remove(e.method,e.methodObj)}DebugUtils.stop("TimerManager:")},t.create=function(t,e,i,n,r,s,o){if(!(0>e||0>i||null==n)){this.remove(n,r);var a=ObjectPool.pop("TimerHandler");a.userFrame=t,a.repeat=0==i,a.repeatCount=i,a.delay=e,a.method=n,a.methodObj=r,a.complateMethod=s,a.complateMethodObj=o,a.exeTime=e+(t?this._currFrame:this._currTime),a.dealTime=this._currTime,this._handlers.push(a),this._count++}},t.doTimer=function(t,e,i,n,r,s){void 0===r&&(r=null),void 0===s&&(s=null),this.create(!1,t,e,i,n,r,s)},t.doFrame=function(t,e,i,n,r,s){void 0===r&&(r=null),void 0===s&&(s=null),this.create(!0,t,e,i,n,r,s)},e(t,"count",function(){return this._count}),t.remove=function(t,e){for(var i=0;i<this._count;i++){var n=this._handlers[i];if(n.method==t&&n.methodObj==e){this._handlers.splice(i,1),ObjectPool.push(n),this._count--;break}}},t.removeAll=function(t){for(var e=0;e<this._count;e++){var i=this._handlers[e];i.methodObj==t&&(this._handlers.splice(e,1),ObjectPool.push(i),this._count--,e--)}},t.isExists=function(t,e){for(var i=0;i<this._count;i++){var n=this._handlers[i];if(n.method==t&&n.methodObj==e)return!0}return!1},t}();egret.registerClass(TimerManager,"TimerManager");var TimerHandler=function(){function t(){this.delay=0,this.repeatCount=0,this.exeTime=0,this.dealTime=0}var e=(__define,t),i=e.prototype;return i.clear=function(){this.method=null,this.methodObj=null,this.complateMethod=null,this.complateMethodObj=null},t}();egret.registerClass(TimerHandler,"TimerHandler");var TweenManager=function(){function t(){}var e=(__define,t);e.prototype;return t.init=function(){this.time=0,this.tweens=[],TimerManager.doFrame(1,0,this.update,this)},t.update=function(t){this.time+=t;for(var e=0;e<this.tweens.length;e++)this.tweens[e].update(t)},t.add=function(t){this.tweens.push(t)},t.remove=function(t){ArrayUtils.remove(this.tweens,t)},t}();egret.registerClass(TweenManager,"TweenManager");var Tween=function(){function t(t){this.obj=t,this.from={},this.to={},this.duration=0,this.delay=0,this.ease=TweenEase.Linear
}var e=(__define,t),i=e.prototype;return i.start=function(){this.time=0,TweenManager.add(this)},i.begin=function(){var t=this.from,e=this.to,i=this.obj;for(var n in e)null==t[n]&&null!=i[n]&&(t[n]=i[n]);for(var n in t)i[n]=t[n]},i.end=function(){var t=this.to,e=this.obj;for(var i in t)e[i]=t[i];this.callBack&&this.callBack()},i.update=function(t){var e=this.time<=this.delay;this.time+=t;var i=(this.time-this.delay)/this.duration;if(i>0){if(i>=1)return this.end(),void this.stop();e&&this.begin();var n=this.ease(i);for(var r in this.to){var s=this.from[r],o=this.to[r];null!=s&&null!=o&&(this.obj[r]=(o-s)*n+s)}this.updateFunc&&this.updateFunc(this.time)}},i.stop=function(){TweenManager.remove(this)},t}();egret.registerClass(Tween,"Tween");var TweenEase=function(){function t(){}var e=(__define,t);e.prototype;return t.Linear=function(t){return t},t.QuadIn=function(t){return t*t},t.QuadOut=function(t){return-(t*(t-2))},t.QuadInOut=function(t){return.5>t?2*t*t:-2*t*t+4*t-1},t.CubicIn=function(t){return t*t*t},t.CubicOut=function(t){var e=t-1;return e*e*e+1},t.CubicInOut=function(t){if(.5>t)return 4*t*t*t;var e=2*t-2;return.5*e*e*e+1},t.QuartIn=function(t){return t*t*t*t},t.QuartOut=function(t){var e=t-1;return e*e*e*(1-t)+1},t.QuartInOut=function(t){if(.5>t)return 8*t*t*t*t;var e=t-1;return-8*e*e*e*e+1},t.QuinIn=function(t){return t*t*t*t*t},t.QuinOut=function(t){var e=t-1;return e*e*e*e*e+1},t.QuinInOut=function(t){if(.5>t)return 16*t*t*t*t*t;var e=2*t-2;return.5*e*e*e*e*e+1},t.SineIn=function(t){return Math.sin((t-1)*Math.PI/2)+1},t.SineOut=function(t){return Math.sin(t*Math.PI/2)},t.SineInOut=function(t){return.5*(1-Math.cos(t*Math.PI))},t.CircIn=function(t){return 1-Math.sqrt(1-t*t)},t.CircOut=function(t){return Math.sqrt((2-t)*t)},t.CircInOut=function(t){return.5>t?.5*(1-Math.sqrt(1-4*(t*t))):.5*(Math.sqrt(-(2*t-3)*(2*t-1))+1)},t.ExpoIn=function(t){return 0==t?t:Math.pow(2,10*(t-1))},t.ExpoOut=function(t){return 1==t?t:1-Math.pow(2,-10*t)},t.ExpoInOut=function(t){return 0==t||1==t?t:.5>t?.5*Math.pow(2,20*t-10):-.5*Math.pow(2,-20*t+10)+1},t.ElasticIn=function(t){return Math.sin(13*Math.PI/2*t)*Math.pow(2,10*(t-1))},t.ElasticOut=function(t){return Math.sin(-13*Math.PI/2*(t+1))*Math.pow(2,-10*t)+1},t.ElasticInOut=function(t){return.5>t?.5*Math.sin(13*Math.PI/2*(2*t))*Math.pow(2,10*(2*t-1)):.5*(Math.sin(-13*Math.PI/2*(2*t-1+1))*Math.pow(2,-10*(2*t-1))+2)},t.BackIn=function(t){return t*t*t-t*Math.sin(t*Math.PI)},t.BackOut=function(t){var e=1-t;return 1-(e*e*e-e*Math.sin(e*Math.PI))},t.BackInOut=function(t){if(.5>t){var e=2*t;return.5*(e*e*e-e*Math.sin(e*Math.PI))}var e=1-(2*t-1);return.5*(1-(e*e*e-e*Math.sin(e*Math.PI)))+.5},t.BounceIn=function(t){return 1-this.BounceOut(1-t)},t.BounceOut=function(t){return 4/11>t?121*t*t/16:8/11>t?9.075*t*t-9.9*t+3.4:.9>t?4356/361*t*t-35442/1805*t+16061/1805:10.8*t*t-20.52*t+10.72},t.BounceInOut=function(t){return.5>t?.5*this.BounceIn(2*t):.5*this.BounceOut(2*t-1)+.5},t}();egret.registerClass(TweenEase,"TweenEase");